<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Dono Bola!</title>

  <style>
    :root{
      --card:#ffffff;
      --ink:#0f172a;
      --muted:#475569;
      --line:rgba(15,23,42,.10);
      --accent:#16a34a;
      --gold:#f59e0b;
      --shadow:0 14px 30px rgba(2,6,23,.12);
      --radius:22px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      color:var(--ink);
      padding:14px 14px 88px; /* Platz f√ºr Bottom-Bar */
      min-height:100vh;
      overflow-x:hidden;

      /* ‚úÖ Ikat/Atlas Pattern (rot/gelb/wei√ü) */
      background:
        radial-gradient(circle at 20% 10%, rgba(255,255,255,.65), transparent 40%),
        radial-gradient(circle at 85% 20%, rgba(255,255,255,.55), transparent 35%),
        url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='240' height='240' viewBox='0 0 240 240'%3E%3Crect width='240' height='240' fill='%23fff'/%3E%3Cg opacity='0.22'%3E%3Cpath d='M120 14 L150 44 L120 74 L90 44 Z' fill='%23d62828'/%3E%3Cpath d='M120 74 L150 104 L120 134 L90 104 Z' fill='%23fcbf49'/%3E%3Cpath d='M120 134 L150 164 L120 194 L90 164 Z' fill='%23d62828'/%3E%3Cpath d='M14 120 L44 90 L74 120 L44 150 Z' fill='%23fcbf49'/%3E%3Cpath d='M74 120 L104 90 L134 120 L104 150 Z' fill='%23d62828'/%3E%3Cpath d='M134 120 L164 90 L194 120 L164 150 Z' fill='%23fcbf49'/%3E%3Cpath d='M194 120 L224 90 L254 120 L224 150 Z' fill='%23d62828'/%3E%3C/g%3E%3C/svg%3E");
      background-size: auto, auto, 240px 240px;
    }

    .app{max-width:820px;margin:0 auto}

    /* Card shell */
    .panel{
      background:rgba(255,255,255,.90);
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      backdrop-filter: blur(6px);
      overflow:hidden;
    }

    /* ‚úÖ Compact header (mobile friendly) */
    .header{
      padding:14px;
      display:flex;
      gap:12px;
      align-items:center;
      justify-content:space-between;
    }
    .hLeft{display:flex; gap:12px; align-items:center; min-width:0;}
    .sunWrap{position:relative; width:64px; height:64px; flex:0 0 auto;}
    .sun{
      width:64px;height:64px;border-radius:999px;
      display:grid;place-items:center;
      background: radial-gradient(circle at 30% 30%, #fff6cc, #fbbf24 55%, #f59e0b 100%);
      box-shadow: 0 10px 24px rgba(245,158,11,.30);
      border: 4px solid rgba(255,255,255,.75);
    }
    .sunPct{font-weight:1000;font-size:16px;color:#7c2d12}

    .titleBlock{min-width:0}
    .appTitle{
      font-weight:1000;
      font-size:18px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    /* ‚úÖ BIG child name line */
    .hello{
      margin-top:4px;
      font-weight:1100;
      font-size:34px;
      line-height:1.05;
      display:flex;
      gap:8px;
      align-items:baseline;
      flex-wrap:wrap;
    }
    .hello .name{color:#166534}
    .hello .spark{opacity:.9}

    /* ‚úÖ very small helper row */
    .microRow{
      margin-top:6px;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      color:rgba(15,23,42,.70);
      font-weight:900;
      font-size:12px;
    }
    .chip{
      background:rgba(255,255,255,.86);
      border:1px solid rgba(15,23,42,.10);
      padding:6px 10px;
      border-radius:999px;
      font-weight:1000;
      font-size:12px;
      display:inline-flex;
      align-items:center;
      gap:8px;
    }
    .chip.hidden{display:none}

    /* PATH AREA */
    .content{padding:0 14px 14px;}
    .pathCard{
      margin-top:10px;
      background:rgba(255,255,255,.88);
      border:1px solid rgba(15,23,42,.10);
      border-radius:18px;
      padding:12px;
      overflow:hidden;
    }

    .pathTitleRow{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      margin-bottom:10px;
    }
    .pathTitle{
      font-weight:1000;
      display:flex;
      gap:10px;
      align-items:center;
    }
    .pathTitle span{opacity:.85; font-size:13px; font-weight:900; color:rgba(15,23,42,.70)}
    .badge{
      padding:6px 10px;
      border-radius:999px;
      border:1px solid rgba(15,23,42,.10);
      background:rgba(255,255,255,.85);
      font-weight:1000;
      font-size:12px;
      white-space:nowrap;
    }

    /* Horizontal path */
    .path{
      display:flex;
      align-items:center;
      gap:10px;
      overflow-x:auto;
      padding-bottom:8px;
      scrollbar-width: thin;
    }
    .node{
      flex:0 0 auto;
      width:78px;
      text-align:center;
      cursor:pointer;
      user-select:none;
    }
    .nodeCircle{
      width:58px;height:58px;
      border-radius:999px;
      margin:0 auto 6px;
      display:grid;
      place-items:center;
      font-size:28px;
      background:rgba(255,255,255,.92);
      border:2px solid rgba(15,23,42,.10);
      box-shadow: 0 10px 18px rgba(2,6,23,.08);
      position:relative;
    }
    .nodeLabel{
      font-weight:1000;
      font-size:12px;
      color:rgba(15,23,42,.82);
      line-height:1.1;
      min-height:28px;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:0 2px;
    }

    .node.locked{opacity:.50; filter: grayscale(.25);}
    .node.locked .nodeCircle{background:rgba(255,255,255,.75);}
    .nodeDoneDot{
      position:absolute;
      right:-2px; bottom:-2px;
      width:18px;height:18px;border-radius:999px;
      background:rgba(22,163,74,.95);
      border:2px solid #fff;
      display:none;
      place-items:center;
      color:#fff;
      font-size:12px;
      font-weight:1000;
    }
    .node.done .nodeDoneDot{display:grid;}

    /* Lesson minimal list (optional) ‚Äì we keep only ONE item: current/next */
    .miniList{
      margin-top:12px;
      display:grid;
      gap:10px;
    }
    .miniLesson{
      display:flex;
      align-items:center;
      gap:12px;
      background:rgba(255,255,255,.92);
      border:1px solid rgba(15,23,42,.10);
      border-radius:18px;
      padding:12px;
    }
    .miniIcon{
      width:64px;height:64px;border-radius:16px;
      display:grid;place-items:center;
      font-size:34px;
      background:rgba(245,158,11,.14);
      border:1px solid rgba(245,158,11,.22);
      flex:0 0 auto;
    }
    .miniText{min-width:0; flex:1}
    .miniMain{font-weight:1100; font-size:18px; line-height:1.1}
    .miniSub{margin-top:4px; color:rgba(15,23,42,.70); font-weight:900; font-size:13px}
    .miniTag{
      background:rgba(22,163,74,.12);
      border:1px solid rgba(22,163,74,.24);
      color:#065f46;
      padding:6px 10px;
      border-radius:999px;
      font-weight:1000;
      font-size:12px;
      white-space:nowrap;
    }
    .miniTag.lock{background:rgba(15,23,42,.08); border-color:rgba(15,23,42,.12); color:rgba(15,23,42,.75)}

    /* Bottom bar (Premium + Name + Reset) */
    .bottomBar{
      position:fixed;
      left:0; right:0; bottom:0;
      padding:10px 14px;
      background: rgba(255,255,255,.92);
      border-top:1px solid rgba(15,23,42,.12);
      backdrop-filter: blur(10px);
      z-index:9999;
    }
    .bottomInner{
      max-width:820px;
      margin:0 auto;
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:space-between;
    }
    .bBtn{
      border:none;
      cursor:pointer;
      border-radius:16px;
      padding:12px 14px;
      font-weight:1000;
      display:inline-flex;
      align-items:center;
      gap:10px;
      white-space:nowrap;
    }
    .bPrimary{
      background: linear-gradient(180deg, #34d399, #22c55e);
      color:#052e1b;
      flex:1;
      justify-content:center;
    }
    .bGhost{
      background: rgba(255,255,255,.92);
      border:1px solid rgba(15,23,42,.12);
      color:rgba(15,23,42,.90);
    }

    /* Paywall modal (demo) */
    .modal{
      position:fixed; inset:0;
      display:none;
      align-items:center; justify-content:center;
      padding:16px;
      background: rgba(2,6,23,.55);
      backdrop-filter: blur(10px);
      z-index:10000;
    }
    .modal.show{display:flex}
    .modalCard{
      width:min(520px, 92vw);
      background: rgba(255,255,255,.95);
      border:1px solid rgba(255,255,255,.35);
      border-radius:26px;
      box-shadow: 0 22px 70px rgba(2,6,23,.35);
      padding:16px;
      text-align:center;
    }
    .modalTitle{font-size:20px;font-weight:1100;margin:6px 0 6px}
    .modalText{margin:0 0 12px;color: rgba(15,23,42,.78);font-weight:900;}
    .modalRow{display:grid; gap:10px; margin-top:10px}
    .modalBtn{
      width:100%;
      padding:14px;
      border-radius:18px;
      border:1px solid rgba(5,46,27,.10);
      background: linear-gradient(180deg, #34d399, #22c55e);
      color:#052e1b;
      font-weight:1000;
      cursor:pointer;
    }
    .modalBtn.secondary{
      background:#fff;
      border:1px solid rgba(15,23,42,.12);
      color:rgba(15,23,42,.90);
    }

    @media (max-width:420px){
      .hello{font-size:30px}
      .appTitle{font-size:16px}
      .sunWrap{width:58px;height:58px}
      .sun{width:58px;height:58px}
    }
  </style>
</head>

<body>
  <div class="app">
    <div class="panel">

      <!-- HEADER -->
      <div class="header">
        <div class="hLeft">
          <div class="sunWrap" aria-hidden="true">
            <div class="sun"><div class="sunPct" id="mainPct">0%</div></div>
          </div>

          <div class="titleBlock">
            <!-- ‚úÖ only Dono Bola! here (no Uzbek-A1) -->
            <div class="appTitle">üåø Dono Bola!</div>

            <!-- ‚úÖ BIG greeting with lion -->
            <div class="hello" id="bigHello">
              ü¶Å <span>Salom,</span> <span class="name" id="nameBig">Do‚Äòst</span><span>!</span>
              <span class="spark">‚ú®</span>
            </div>

            <!-- ‚úÖ minimal micro info -->
            <div class="microRow">
              <div class="chip hidden" id="yutuqChip">üèÖ Yutuq</div>
              <div class="chip" id="modeChip">üéßüó£Ô∏èüé≤</div>
            </div>
          </div>
        </div>
      </div>

      <!-- CONTENT -->
      <div class="content">
        <!-- ‚úÖ ONE combined path area -->
        <div class="pathCard">
          <div class="pathTitleRow">
            <div class="pathTitle">üß≠ O‚Äòquv yo‚Äòli <span>(10 dars)</span></div>
            <div class="badge" id="premiumBadge">BEPUL</div>
          </div>

          <div class="path" id="path"></div>

          <!-- Optional: only show current/next lesson minimal card -->
          <div class="miniList" id="miniList"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Bottom bar -->
  <div class="bottomBar">
    <div class="bottomInner">
      <button class="bBtn bPrimary" id="premiumBtn">üîì Premium</button>
      <button class="bBtn bGhost" id="nameBtn">‚úèÔ∏è Ism</button>
      <button class="bBtn bGhost" id="resetBtn">‚ôªÔ∏è Reset</button>
    </div>
  </div>

  <!-- Paywall (demo) -->
  <div class="modal" id="paywall">
    <div class="modalCard" role="dialog" aria-modal="true">
      <div style="font-size:44px; line-height:1;">üîì‚ú®</div>
      <div class="modalTitle">To‚Äòliq versiya</div>
      <p class="modalText">
        Bir marta to‚Äòlov ‚úÖ<br>
        Barcha darslar umrbod ochiladi üîì
      </p>

      <div class="modalRow">
        <button class="modalBtn" id="buyBtn">üîì OCHISH (Demo)</button>
        <button class="modalBtn secondary" id="closePaywallBtn">Yopish</button>
      </div>
      <p class="modalText" style="margin-top:12px;font-size:12px;opacity:.75">
        Hozir GitHub demo. Keyin Play Store‚Äôda haqiqiy to‚Äòlov bo‚Äòladi.
      </p>
    </div>
  </div>

<script>
  /* ========= SETTINGS ========= */
  const PREMIUM_KEY = "premium_unlocked";
  const NAME_KEY = "childName";
  const COMPLETED_KEY = "completedLessons"; // {"1":true,"2":false...}

  function isPremium(){ return localStorage.getItem(PREMIUM_KEY) === "true"; }
  function setPremium(v){ localStorage.setItem(PREMIUM_KEY, v ? "true" : "false"); }

  function getCompleted(){
    try { return JSON.parse(localStorage.getItem(COMPLETED_KEY) || "{}"); }
    catch { return {}; }
  }

  // ‚úÖ 10 lessons (du kannst Titel sp√§ter √§ndern)
  const LESSONS = [
    { id:1, emoji:"üëã", title:"Salomlashuv", href:"lesson1.html", free:true },
    { id:2, emoji:"üî¢", title:"Sonlar",      href:"lesson2.html", free:false },
    { id:3, emoji:"üêæ", title:"Hayvonlar",   href:"lesson3.html", free:false },
    { id:4, emoji:"üé®", title:"Ranglar",     href:"lesson4.html", free:false },
    { id:5, emoji:"üçé", title:"Mevalar",     href:"lesson5.html", free:false },
    { id:6, emoji:"üëï", title:"Kiyimlar",    href:"lesson6.html", free:false },
    { id:7, emoji:"üè†", title:"Uy",          href:"lesson7.html", free:false },
    { id:8, emoji:"üöó", title:"Transport",   href:"lesson8.html", free:false },
    { id:9, emoji:"üçΩÔ∏è", title:"Ovqat",      href:"lesson9.html", free:false },
    { id:10,emoji:"üå¶Ô∏è", title:"Ob-havo",    href:"lesson10.html",free:false },
  ];

  /* ========= NAME ========= */
  function normalizeName(s){
    return (s || "").trim().replace(/\s+/g, " ").slice(0, 18);
  }
  function askName(){
    const current = localStorage.getItem(NAME_KEY) || "";
    const n = prompt("Ism kiriting:", current);
    if(n === null) return;
    const clean = normalizeName(n);
    if(clean.length >= 2){
      localStorage.setItem(NAME_KEY, clean);
      applyGreeting();
    }
  }
  function applyGreeting(){
    const name = localStorage.getItem(NAME_KEY) || "Do‚Äòst";
    document.getElementById("nameBig").innerText = name;

    // Lion greets (always visible)
    document.getElementById("bigHello").innerHTML =
      `ü¶Å <span>Salom,</span> <span class="name" id="nameBig">${name}</span><span>!</span> <span class="spark">‚ú®</span>`;
  }

  /* ========= UI ========= */
  function openPaywall(){ document.getElementById("paywall").classList.add("show"); }
  function closePaywall(){ document.getElementById("paywall").classList.remove("show"); }

  function updatePremiumBadge(){
    const b = document.getElementById("premiumBadge");
    const btn = document.getElementById("premiumBtn");
    if(isPremium()){
      b.textContent = "OCHIQ ‚úÖ";
      btn.textContent = "‚úÖ Premium";
    }else{
      b.textContent = "BEPUL";
      btn.textContent = "üîì Premium";
    }
  }

  // ‚úÖ very minimal: show Yutuq only if any completed lesson
  function updateYutuq(){
    const completed = getCompleted();
    const doneCount = Object.values(completed).filter(Boolean).length;
    const chip = document.getElementById("yutuqChip");
    chip.classList.toggle("hidden", doneCount === 0);
  }

  // ‚úÖ Progress percent based on completed lessons (not words)
  function updateSunPct(){
    const completed = getCompleted();
    const doneCount = Object.values(completed).filter(Boolean).length;
    const pct = Math.round((doneCount / LESSONS.length) * 100);
    document.getElementById("mainPct").innerText = pct + "%";
  }

  // Access rule:
  // - Lesson 1 always free
  // - If premium => all open
  // - Else: only next lesson after previous completed (classic path)
  function isLessonOpen(lessonId){
    if(lessonId === 1) return true;
    if(isPremium()) return true;

    const completed = getCompleted();
    // open if previous lesson completed
    return !!completed[String(lessonId - 1)];
  }

  function renderPath(){
    const wrap = document.getElementById("path");
    wrap.innerHTML = "";

    const completed = getCompleted();

    LESSONS.forEach(lsn => {
      const open = isLessonOpen(lsn.id);
      const done = !!completed[String(lsn.id)];

      const node = document.createElement("div");
      node.className = "node" + (open ? "" : " locked") + (done ? " done" : "");
      node.innerHTML = `
        <div class="nodeCircle">
          <div class="nodeDoneDot">‚úì</div>
          ${lsn.emoji}
        </div>
        <div class="nodeLabel">${lsn.title}</div>
      `;

      node.addEventListener("click", () => {
        if(open){
          window.location.href = lsn.href;
        } else {
          openPaywall();
        }
      });

      wrap.appendChild(node);
    });
  }

  // ‚úÖ show only ONE minimal card: first locked or next open lesson
  function renderMiniCard(){
    const list = document.getElementById("miniList");
    list.innerHTML = "";

    const completed = getCompleted();
    let target = LESSONS.find(lsn => !completed[String(lsn.id)]) || LESSONS[LESSONS.length-1];

    const open = isLessonOpen(target.id);
    const tagText = open ? "OCHIQ" : "üîí";
    const tagClass = open ? "miniTag" : "miniTag lock";

    const card = document.createElement("div");
    card.className = "miniLesson";
    card.innerHTML = `
      <div class="miniIcon">${target.emoji}</div>
      <div class="miniText">
        <div class="miniMain">${target.title}</div>
      </div>
      <div class="${tagClass}">${tagText}</div>
    `;

    card.addEventListener("click", () => {
      if(open) window.location.href = target.href;
      else openPaywall();
    });

    list.appendChild(card);
  }

  function updateAll(){
    applyGreeting();
    updatePremiumBadge();
    updateYutuq();
    updateSunPct();
    renderPath();
    renderMiniCard();
  }

  /* ========= EVENTS ========= */
  document.getElementById("nameBtn").addEventListener("click", askName);

  document.getElementById("premiumBtn").addEventListener("click", () => {
    if(isPremium()){
      alert("‚úÖ Premium allaqachon ochiq!");
    }else{
      openPaywall();
    }
  });

  document.getElementById("buyBtn").addEventListener("click", () => {
    setPremium(true);
    closePaywall();
    updateAll();
    alert("üéâ Premium ochildi!");
  });

  document.getElementById("closePaywallBtn").addEventListener("click", closePaywall);
  document.getElementById("paywall").addEventListener("click", (e) => {
    if(e.target.id === "paywall") closePaywall();
  });

  document.getElementById("resetBtn").addEventListener("click", () => {
    const ok = confirm("Hammasini qaytadan boshlaymizmi?");
    if(!ok) return;
    // keep name
    const name = localStorage.getItem(NAME_KEY);
    localStorage.clear();
    if(name) localStorage.setItem(NAME_KEY, name);
    updateAll();
  });

  window.addEventListener("load", () => {
    if(!localStorage.getItem(NAME_KEY)){
      // simple first-time name prompt
      setTimeout(askName, 250);
    }
    updateAll();
  });

  // üß™ Debug: Shift+P removes premium
  document.addEventListener("keydown", (e) => {
    if(e.shiftKey && (e.key === "P" || e.key === "p")){
      localStorage.removeItem(PREMIUM_KEY);
      alert("üß™ Premium o‚Äòchirildi");
      updateAll();
    }
  });
</script>
</body>
</html>
